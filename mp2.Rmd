---
title: "Mini-Project 2"
author: "Your Name Here"
date: "October 31, 2017"
output: html_document
---


## Loading the data


```{r, include=FALSE}
load("house_elections.rda")
load("candidates.rda")
load("committees.rda")
load("contributions.rda")
```


```{r}
library(dplyr)
library(tidyverse)
library(ggplot2)
```

```{r}
glimpse(candidates)
```

```{r}
glimpse(committees)
```

```{r}
glimpse(contributions)
```

```{r}
glimpse(house_elections)
```


```{r}
transaction_info <- contributions %>%
  group_by(transaction_type, cand_id) %>%
  summarise(transaction_total = sum(transaction_amt))

glimpse(transaction_info)
```

```{r}
candidates_info <- candidates %>%
  group_by(cand_id, cand_name)

candidates_info <- candidates_info[,c("cand_id", "cand_name")]

glimpse(candidates_info)
```

```{r}
transaction_and_candidate <- transaction_info %>%
  inner_join(candidates_info, by = c("cand_id"))

glimpse(transaction_and_candidate)
```

```{r}
most_expensive_pres_candidates <- transaction_and_candidate %>%
  group_by(cand_name, cand_id) %>%
  summarise(contribution_total = sum(transaction_total))
```

```{r}
transaction_and_pres_candidates <- transaction_and_candidate %>%
  filter(cand_id == "P80003338" | cand_id == "P80003353")

glimpse(transaction_and_pres_candidates)
```

```{r}
support_pres_candidates <- transaction_and_pres_candidates %>%
  group_by(cand_id, cand_name) %>%
  mutate(support_true = transaction_type  %in% c("24C", "24E", "24F", "24K", "24Z"))
```

```{r}
support_total_pres_candidates <- support_pres_candidates %>%
  group_by(cand_id, cand_name, support_true) %>%
  summarise(support_total = sum(transaction_total))
```

```{r}
library(RColorBrewer)
display.brewer.all()
```

```{r}
ggplot(support_total_pres_candidates, aes(x = cand_name, y = support_total, fill = support_true)) +
  geom_bar(stat = "identity") +
  ggtitle("Financial Allocations Toward\n2012 Presidential Candidates") +
  scale_x_discrete("Candidates", labels = c("Barack Obama", "Mitt Romney")) + 
  scale_y_continuous("Amount Spent", labels = scales::dollar) +
  labs(fill = "Allocation Objective") +
  scale_fill_brewer(palette = "Set1", labels = c("Opposing Candidate", "Supporting Candidate")) +
  theme(plot.title = element_text(hjust = 0.5, size = 20, face = "bold"),
        axis.ticks.length = unit(0.50, "cm"),
        panel.background = element_rect(fill = "white"),
        panel.grid.major = element_line(colour = "white"),
        panel.grid.minor = element_line(colour = "white"),
        legend.title = element_text(size = 15), 
        legend.text = element_text(size = 13),
        axis.title = element_text(size = 20),
        axis.text = element_text(size = 15),
        axis.ticks.x = element_blank())
```

  

